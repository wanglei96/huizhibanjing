<!DOCTYPE html>
<html>
<head>
<title>Test.html</title>

<meta http-equiv="keywords" content="keyword1,keyword2,keyword3">
<meta http-equiv="description" content="this is my page">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">

<script type="text/javascript" src="../../js/jquery.js"></script>
<script type="text/javascript" src="../../js/common.js"></script>
<script type="text/javascript" src="../../js/config.js"></script>
<script type="text/javascript" src="../../js/json2.js"></script>
<script>
	//查询
	$(document).ready(function(){
	        //    var pageIndex = 0;
		//$(function() {
		//	$("#btnQuery").click(function() {
				var data = new Object();
				//data.tableName = "view_sys_user";
				/* data.orderBy = "create_time desc";
				data.condition = getCondition();
				data.pageIndex = pageIndex;//可选
				data.pageSize = 10;//可选 */
			  //  alert(JSON.stringify(data));
				call("", data, function(result) {
				alert(JSON.stringify(result.data.dataList));
					outputList(result.data.dataList);
				});
		//	})
		//});
	});
		function outputList(dataList) {
			$("#tableList tr:gt(0)").remove();
			for ( var i = 0; i < dataList.length; i++) {			
				var dataItem = dataList[i];
					outputListItem(dataItem);			
			}
		}
		function outputListItem(dataItem) {
			var htmlTr = "<tr>";
			htmlTr += "<td>" + dataItem.id + "</td>";
			htmlTr += "<td>" + dataItem.login_name + "</td>";
			htmlTr += "<td>"
					+ (dataItem.true_name == null ? "" : dataItem.true_name)
					+ "</td>";
				htmlTr += "<td>"
						+ (dataItem.sys_organization_name == null ? ""
								: dataItem.sys_organization_name) + "</td>";
				htmlTr += "<td>";
			
			htmlTr += "<a href='javascript:void(0)' onclick='selectSysUser("+dataItem.id+")'>查看</a>";
			htmlTr += "<a href='javascript:void(0)' onclick='selectSysUser("+dataItem.id+")'>修改</a>";
		    htmlTr += "<a href='javascript:void(0)' onclick='deleteSysUser("+dataItem.id+")'>删除</a>";					
			htmlTr += "</td>";
			htmlTr += "</tr>";
			console.log(htmlTr);
			$("#tableList").append(htmlTr);
		}
	
	//删除
	function deleteSysUser(id){
		alert(id);
		var data = new Object();
		data.tableName = "sys_user";
		data.id = id;
		call("DeleteSysUser", data, function(result) {
			window.location.href="Test.html";
		});
	}
	//查看
	function selectSysUser(id){	
	 	 $("#hid").attr("value",id);
		var data = getEntityForSelectOne();
		call("GetService", data, function(result) {
				alert(JSON.stringify(result.data));
			$("#save").show();
			 $("#saveSysUser").hide();
			 $("#updateSysUser").show();		 
		   $("#txLoginName").val(result.data.loginName);
		   $("#txPassword").val(result.data.password);	
			   
		});	 
	}
	function getEntityForSelectOne(){
		var id= $("#hid").attr("value");	
		var newSysUser = new Object();
		newSysUser.id=id;
		return newSysUser;
	}
	//修改
	function updateSysUser(){

			var data =updateGetEntity();
			call("UpdateSysUser", data, function(result) {
			//	alert(JSON.stringify(result.data));
				window.location.href="Test.html";
			});
	}
	function updateGetEntity(){
		var id = $("#hid").attr("value");
		//alert(id);
		var name = $("#txLoginName").val();
		var newSysUser = new Object();
		newSysUser.loginName = name;
		newSysUser.id =id;
		return newSysUser;
	}
	//弹出隐藏div
	 $(function() {
	  $("#btnAdd").click(function() {
	  	$("#save").show();
	  	 $("#updateSysUser").hide();
		})
	});
	//新增
	function saveSysUser(){
		var data = getEntity();
			call("AddSysUser", data, function(result) {
		//	alert(JSON.stringify(result.data));
			window.location.href="Test.html";
		});
		}
	function getEntity() {
		var name = $("#txLoginName").val();
		var pwd = $("#txPassword").val();
		var newSysUser = new Object();
		newSysUser.loginName = name;
		newSysUser.password = pwd;
		return newSysUser;
	}
	$(function() {
		//弹出SysRoleList页面
	  $("#btnSysRole").click(function() {
		window.location.href="SysRoleList.html";
		});
		//弹出btnSysMenu页面
	  $("#btnSysMenu").click(function() {
		window.location.href="SysMenuList.html";
		});
		//弹出btnSysMenu页面
	  $("#btnSysOrganization").click(function() {
		window.location.href="SysOrganizationList.html";
		});
		///弹出btnSysMenuType页面
		$("#btnSysMenuType").click(function() {
		window.location.href="SysMenuTypeList.html";
		});
	});
</script>
</head>

<body>
	<div class="title_bar">测试页面</div>
	<div class="command_bar">
		<input id="btnQuery" value="查询" type="button" onclick="selectSysUser();"/>
		<input id="btnAdd" value="新增" type="button" />
		<input id="btnSysMenu" value="sysMenu" type="button"/>
		<input id="btnSysRole" value="sysRole" type="button"/>
		<input id="btnSysOrganization" value="sysOrganization" type="button"/>
		<input id="btnSysMenuType" value="sysMenuType" type="button"/>
	</div>
	<div class="query_panel">
		<div class="query_item">
			<div class="query_item_caption">账号：</div>
			<div class="query_item_value">
				<input type="text" class="query_item_textbox" id="txtLoginName">
			</div>
		</div>
		<div class="query_item">
			<div class="query_item_caption">姓名：</div>
			<div class="query_item_value">
				<input type="text" class="query_item_textbox" id="txtTrueName">
			</div>
		</div>
	</div>
	<div class="grid_panel">
		<table id="tableList">
			<tr>
				<td>编号</td>
				<td>账号</td>
				<td>姓名</td>
				<td>部门</td>
				<td>操作</td>
			</tr>
		</table>
	</div>
	<div clas s="total_panel" ></div>
	
	<div align="" id ="save" style="display:none ;">
    	<table  width="500" border="1" cellpadding="0" cellspacing="0">
        	<tr>
            	<td colspan="2" align="center">新增</td>
            </tr>
            <tr>	
            	<td align="right">账号：</td>
                <td> <input type="text" name="txLoginName" id="txLoginName" value=""/></td>
            </tr>
            <tr>	
            	<td align="right">密码：</td>
                <td> <input type="password" name="txtPassword" id="txPassword" value=""/></td>
            </tr>
            <tr>
            	<td align="center" colspan="2">
            		<input type="hidden" id="hid" value=""/>
                	<input type="button" id="saveSysUser"  onclick="saveSysUser()" value="提交"/>
                	<input type="button" id="updateSysUser"  onclick="updateSysUser()" value="修改"/>
                    <input type="button" id="" onclick="javascript:history.go(0);" value="取消"/>
                </td>
            </tr>
        </table>
    </div>
</body>
</html>