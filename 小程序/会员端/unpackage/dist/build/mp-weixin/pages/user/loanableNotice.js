(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/loanableNotice"],{4003:function(e,o,a){"use strict";a.d(o,"b",(function(){return n})),a.d(o,"c",(function(){return t})),a.d(o,"a",(function(){}));var n=function(){var e=this.$createElement;this._self._c},t=[]},"4dce":function(e,o,a){"use strict";var n=a("65ad"),t=a.n(n);t.a},"65ad":function(e,o,a){},"6ecc":function(e,o,a){"use strict";a.r(o);var n=a("724a"),t=a.n(n);for(var i in n)["default"].indexOf(i)<0&&function(e){a.d(o,e,(function(){return n[e]}))}(i);o["default"]=t.a},"724a":function(e,o,a){"use strict";(function(e){var n=a("4ea4");Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var t=n(a("448a")),i=n(a("c52e")),d=n(a("bd74")),c=(n(a("f0ad")),e.getSystemInfoSync().statusBarHeight),l=null,u={data:function(){return{url:"http://admin.8630.net/WYB/UploadFile/headerTopbg.png",imageRootUrl:d.default.imageRootUrl,adminRootUrl:d.default.adminRootUrl+"/",statusBarHeight:c,head_is_fixed:0,tabbarIndex:0,typeList:["可借","不可借"],current:0,items:["可借","不可借"],styleType:"button",activeColor:"#53D776",list:[{id:1,url:d.default.imageRootUrl+"image/common/bookb1.jpg",name:"密码花园",typeList:[{code:"",name:"0-2岁"},{code:"",name:"3-6岁"},{code:"",name:"11-14岁"},{code:"",name:"洞洞翻翻纸板书"},{code:"",name:"精装"},{code:"",name:"获奖"},{code:"",name:"国家大师名作套系"}]},{id:2,url:d.default.imageRootUrl+"image/common/bookb2.jpg",name:"安徒生童话全集",typeList:[{code:"",name:"0-2岁"},{code:"",name:"3-6岁"},{code:"",name:"11-14岁"},{code:"",name:"绘本认知"},{code:"",name:"洞洞翻翻纸板书"},{code:"",name:"精装"},{code:"",name:"获奖"},{code:"",name:"国家大师名作套系"}]},{id:3,url:d.default.imageRootUrl+"image/common/bookb3.jpg",name:"窗边的小豆豆",typeList:[{code:"",name:"0-2岁"},{code:"",name:"3-6岁"},{code:"",name:"11-14岁"},{code:"",name:"绘本认知"},{code:"",name:"洞洞翻翻纸板书"},{code:"",name:"精装"},{code:"",name:"获奖"},{code:"",name:"国家大师名作套系"}]},{id:4,url:d.default.imageRootUrl+"image/common/bookb4.jpg",name:"夏洛的网",typeList:[{code:"",name:"0-2岁"},{code:"",name:"3-6岁"},{code:"",name:"11-14岁"},{code:"",name:"绘本认知"},{code:"",name:"洞洞翻翻纸板书"},{code:"",name:"精装"},{code:"",name:"获奖"},{code:"",name:"国家大师名作套系"}]},{id:5,url:d.default.imageRootUrl+"image/common/bookb5.jpg",name:"柳林风声",typeList:[{code:"",name:"0-2岁"},{code:"",name:"3-6岁"},{code:"",name:"11-14岁"},{code:"",name:"绘本认知"},{code:"",name:"洞洞翻翻纸板书"},{code:"",name:"精装"},{code:"",name:"获奖"},{code:"",name:"国家大师名作套系"}]},{id:6,url:d.default.imageRootUrl+"image/common/bookb6.jpg",name:"格林童话",typeList:[{code:"",name:"0-2岁"},{code:"",name:"3-6岁"},{code:"",name:"11-14岁"},{code:"",name:"绘本认知"},{code:"",name:"洞洞翻翻纸板书"},{code:"",name:"精装"},{code:"",name:"获奖"},{code:"",name:"国家大师名作套系"}]}],available:">",bookSkuInfoList:[],loadingText:"正在加载...",showLoadMore:!1,pageIndex:0,pageSize:10,pageCount:0}},components:{},onReady:function(){},onShow:function(){},onPageScroll:function(e){l.head_is_fixed=e.scrollTop>0?1:0},onPullDownRefresh:function(){e.stopPullDownRefresh()},onReachBottom:function(){l.pageIndex+1==l.pageCount?l.loadingText="没有更多数据了":l.pageIndex+1<l.pageCount&&(l.pageIndex=l.pageIndex+1,this.showLoadMore=!0,l.loadingText="加载更多",l.bindData())},onLoad:function(){l=this,l.bookSkuInfoList=[],l.bindData()},methods:{bindData:function(){var e={borrowMemberId:7,orderBy:"create_time"};e.available=l.available,e.pageIndex=l.pageIndex,e.pageSize=l.pageSize,i.default.call("GetViewBookSkuInfoList",e,(function(e){for(var o,a=0;a<e.data.dataList.length;a++){var n=e.data.dataList[a].ageGroupNames,i=e.data.dataList[a].bookTagNames;if(""!=n&&null!=n&&"null"!=n){var d=n.split(",");e.data.dataList[a].ageGroupNameList=d}else e.data.dataList[a].ageGroupNameList=[];if(""!=i&&null!=i&&"null"!=i){var c=i.split(",");e.data.dataList[a].bookTagList=c}else e.data.dataList[a].bookTagList=[]}(o=l.bookSkuInfoList).push.apply(o,(0,t.default)(e.data.dataList)),l.pageCount=e.data.pageCount,l.pageIndex=e.data.pageIndex,l.pageSize=e.data.pageSize,(0==l.bookSkuInfoList.length||l.bookSkuInfoList.length<=10)&&(l.showLoadMore=!0,l.loadingText="没有更多数据了"),console.log(l.bookSkuInfoList)}))},clickBorrow:function(o,a){var n={memberId:7};n.book_sku_id=o.id,n.fields="count(*) as count",i.default.call("GetViewBookOrderItemList",n,(function(n){n.data.dataList[0].count>0?e.showModal({title:"提示",content:"您已经借过了是否还要借",showCancel:!0,success:function(e){e.confirm&&l.Borrow(o.id,a)}}):l.Borrow(o.id,a)}))},Borrow:function(o,a){var n={memberId:7,companyId:35};n.bookSkuId=o,i.default.call("AddOnLineBorrowBookOrder",n,(function(n){console.log(n),e.showModal({title:"提示",content:"借阅成功！",showCancel:!1,confirmText:"确定"});var t={id:o};l.deleteNotice(t,a)}),(function(o){console.log(o),0==o.success&&e.showModal({title:"提示",content:o.errorMessage,showCancel:!1,confirmText:"确定"})}))},deleteNotice:function(e,o){var a={tableName:"member_book_subscription"};a.condition="member_id = 7 and book_sku_id="+e.id,i.default.call("DeleteMemberBookSubscription",a,(function(e){l.bookSkuInfoList.splice(o,1)}))},clickCancelNotice:function(o,a){var n={tableName:"member_book_subscription"};n.condition="member_id = 7 and book_sku_id="+o.id,i.default.call("DeleteMemberBookSubscription",n,(function(o){e.showModal({title:"提示",content:"取消成功！",showCancel:!1,success:function(e){e.confirm&&l.bookSkuInfoList.splice(a,1)}})}))},onClickItem:function(e){this.current!==e.currentIndex&&(this.current=e.currentIndex),l.bookSkuInfoList=[],l.bindData()},showType:function(e){this.tabbarIndex=e,l.available=0==e?">":"=",l.bookSkuInfoList=[],l.bindData()},clickToBack:function(){e.navigateBack()}}};o.default=u}).call(this,a("543d")["default"])},"7ec2":function(e,o,a){"use strict";a.r(o);var n=a("4003"),t=a("6ecc");for(var i in t)["default"].indexOf(i)<0&&function(e){a.d(o,e,(function(){return t[e]}))}(i);a("4dce");var d=a("f0c5"),c=Object(d["a"])(t["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);o["default"]=c.exports},a509:function(e,o,a){"use strict";(function(e,o){var n=a("4ea4");a("7037");n(a("66fd"));var t=n(a("7ec2"));e.__webpack_require_UNI_MP_PLUGIN__=a,o(t.default)}).call(this,a("bc2e")["default"],a("543d")["createPage"])}},[["a509","common/runtime","common/vendor"]]]);