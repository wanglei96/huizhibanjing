(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/user/loanableNotice"],{"0221":function(e,o,n){"use strict";n.r(o);var t=n("0d4d"),a=n("670a");for(var i in a)"default"!==i&&function(e){n.d(o,e,(function(){return a[e]}))}(i);n("943b");var c,d=n("f0c5"),r=Object(d["a"])(a["default"],t["b"],t["c"],!1,null,null,null,!1,t["a"],c);o["default"]=r.exports},"0d4d":function(e,o,n){"use strict";var t;n.d(o,"b",(function(){return a})),n.d(o,"c",(function(){return i})),n.d(o,"a",(function(){return t}));var a=function(){var e=this,o=e.$createElement;e._self._c},i=[]},"2e28":function(e,o,n){"use strict";(function(e){n("0d5a");t(n("66fd"));var o=t(n("0221"));function t(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=n,e(o.default)}).call(this,n("543d")["createPage"])},"670a":function(e,o,n){"use strict";n.r(o);var t=n("abe7"),a=n.n(t);for(var i in t)"default"!==i&&function(e){n.d(o,e,(function(){return t[e]}))}(i);o["default"]=a.a},"943b":function(e,o,n){"use strict";var t=n("ec94"),a=n.n(t);a.a},abe7:function(e,o,n){"use strict";(function(e){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var t=i(n("f619")),a=i(n("a51b"));i(n("c8b1"));function i(e){return e&&e.__esModule?e:{default:e}}function c(e){return l(e)||u(e)||r(e)||d()}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function r(e,o){if(e){if("string"===typeof e)return s(e,o);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,o):void 0}}function u(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function l(e){if(Array.isArray(e))return s(e)}function s(e,o){(null==o||o>e.length)&&(o=e.length);for(var n=0,t=new Array(o);n<o;n++)t[n]=e[n];return t}var m=e.getSystemInfoSync().statusBarHeight,f=null,b={data:function(){return{url:"http://admin.8630.net/WYB/UploadFile/headerTopbg.png",imageRootUrl:a.default.imageRootUrl,adminRootUrl:a.default.adminRootUrl+"/",statusBarHeight:m,head_is_fixed:0,tabbarIndex:0,typeList:["可借","不可借"],current:0,items:["可借","不可借"],styleType:"button",activeColor:"#53D776",list:[{id:1,url:a.default.imageRootUrl+"image/common/bookb1.jpg",name:"密码花园",typeList:[{code:"",name:"0-2岁"},{code:"",name:"3-6岁"},{code:"",name:"11-14岁"},{code:"",name:"洞洞翻翻纸板书"},{code:"",name:"精装"},{code:"",name:"获奖"},{code:"",name:"国家大师名作套系"}]},{id:2,url:a.default.imageRootUrl+"image/common/bookb2.jpg",name:"安徒生童话全集",typeList:[{code:"",name:"0-2岁"},{code:"",name:"3-6岁"},{code:"",name:"11-14岁"},{code:"",name:"绘本认知"},{code:"",name:"洞洞翻翻纸板书"},{code:"",name:"精装"},{code:"",name:"获奖"},{code:"",name:"国家大师名作套系"}]},{id:3,url:a.default.imageRootUrl+"image/common/bookb3.jpg",name:"窗边的小豆豆",typeList:[{code:"",name:"0-2岁"},{code:"",name:"3-6岁"},{code:"",name:"11-14岁"},{code:"",name:"绘本认知"},{code:"",name:"洞洞翻翻纸板书"},{code:"",name:"精装"},{code:"",name:"获奖"},{code:"",name:"国家大师名作套系"}]},{id:4,url:a.default.imageRootUrl+"image/common/bookb4.jpg",name:"夏洛的网",typeList:[{code:"",name:"0-2岁"},{code:"",name:"3-6岁"},{code:"",name:"11-14岁"},{code:"",name:"绘本认知"},{code:"",name:"洞洞翻翻纸板书"},{code:"",name:"精装"},{code:"",name:"获奖"},{code:"",name:"国家大师名作套系"}]},{id:5,url:a.default.imageRootUrl+"image/common/bookb5.jpg",name:"柳林风声",typeList:[{code:"",name:"0-2岁"},{code:"",name:"3-6岁"},{code:"",name:"11-14岁"},{code:"",name:"绘本认知"},{code:"",name:"洞洞翻翻纸板书"},{code:"",name:"精装"},{code:"",name:"获奖"},{code:"",name:"国家大师名作套系"}]},{id:6,url:a.default.imageRootUrl+"image/common/bookb6.jpg",name:"格林童话",typeList:[{code:"",name:"0-2岁"},{code:"",name:"3-6岁"},{code:"",name:"11-14岁"},{code:"",name:"绘本认知"},{code:"",name:"洞洞翻翻纸板书"},{code:"",name:"精装"},{code:"",name:"获奖"},{code:"",name:"国家大师名作套系"}]}],available:">",bookSkuInfoList:[],loadingText:"正在加载...",showLoadMore:!1,pageIndex:0,pageSize:10,pageCount:0}},components:{},onReady:function(){},onShow:function(){},onPageScroll:function(e){f.head_is_fixed=e.scrollTop>0?1:0},onPullDownRefresh:function(){e.stopPullDownRefresh()},onReachBottom:function(){f.pageIndex+1==f.pageCount?f.loadingText="没有更多数据了":f.pageIndex+1<f.pageCount&&(f.pageIndex=f.pageIndex+1,this.showLoadMore=!0,f.loadingText="加载更多",f.bindData())},onLoad:function(){f=this,f.bookSkuInfoList=[],f.bindData()},methods:{bindData:function(){var e={borrowMemberId:7,orderBy:"create_time"};e.available=f.available,e.pageIndex=f.pageIndex,e.pageSize=f.pageSize,t.default.call("GetViewBookSkuInfoList",e,(function(e){for(var o,n=0;n<e.data.dataList.length;n++){var t=e.data.dataList[n].ageGroupNames,a=e.data.dataList[n].bookTagNames;if(""!=t&&null!=t&&"null"!=t){var i=t.split(",");e.data.dataList[n].ageGroupNameList=i}else e.data.dataList[n].ageGroupNameList=[];if(""!=a&&null!=a&&"null"!=a){var d=a.split(",");e.data.dataList[n].bookTagList=d}else e.data.dataList[n].bookTagList=[]}(o=f.bookSkuInfoList).push.apply(o,c(e.data.dataList)),f.pageCount=e.data.pageCount,f.pageIndex=e.data.pageIndex,f.pageSize=e.data.pageSize,(0==f.bookSkuInfoList.length||f.bookSkuInfoList.length<=10)&&(f.showLoadMore=!0,f.loadingText="没有更多数据了"),console.log(f.bookSkuInfoList)}))},clickBorrow:function(o,n){var a={memberId:7};a.book_sku_id=o.id,a.fields="count(*) as count",t.default.call("GetViewBookOrderItemList",a,(function(t){t.data.dataList[0].count>0?e.showModal({title:"提示",content:"您已经借过了是否还要借",showCancel:!0,success:function(e){e.confirm&&f.Borrow(o.id,n)}}):f.Borrow(o.id,n)}))},Borrow:function(o,n){var a={memberId:7,companyId:35};a.bookSkuId=o,t.default.call("AddOnLineBorrowBookOrder",a,(function(t){console.log(t),e.showModal({title:"提示",content:"借阅成功！",showCancel:!1,confirmText:"确定"});var a={id:o};f.deleteNotice(a,n)}),(function(o){console.log(o),0==o.success&&e.showModal({title:"提示",content:o.errorMessage,showCancel:!1,confirmText:"确定"})}))},deleteNotice:function(e,o){var n={tableName:"member_book_subscription"};n.condition="member_id = 7 and book_sku_id="+e.id,t.default.call("DeleteMemberBookSubscription",n,(function(e){f.bookSkuInfoList.splice(o,1)}))},clickCancelNotice:function(o,n){var a={tableName:"member_book_subscription"};a.condition="member_id = 7 and book_sku_id="+o.id,t.default.call("DeleteMemberBookSubscription",a,(function(o){e.showModal({title:"提示",content:"取消成功！",showCancel:!1,success:function(e){e.confirm&&f.bookSkuInfoList.splice(n,1)}})}))},onClickItem:function(e){this.current!==e.currentIndex&&(this.current=e.currentIndex),f.bookSkuInfoList=[],f.bindData()},showType:function(e){this.tabbarIndex=e,f.available=0==e?">":"=",f.bookSkuInfoList=[],f.bindData()},clickToBack:function(){e.navigateBack()}}};o.default=b}).call(this,n("543d")["default"])},ec94:function(e,o,n){}},[["2e28","common/runtime","common/vendor"]]]);